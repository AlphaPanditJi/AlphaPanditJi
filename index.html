<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Alpha Pandit Ji - Premium Spiritual Content & Exclusive Services</title>
<style>
  /* ---------- base ---------- */
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Inter','Roboto',sans-serif;background:#f5f5f5;color:#111;line-height:1.5;overflow-x:hidden}
  a{color:inherit}
  img{max-width:100%;display:block}

  /* ---------- progress bar ---------- */
  .progress-bar{position:fixed;top:0;left:0;height:4px;background:linear-gradient(90deg,#667eea 0%,#764ba2 50%,#f093fb 100%);z-index:9999;transition:width .12s}

  /* ---------- notice ---------- */
  .notice-banner{background:linear-gradient(135deg,#ff6b6b 0%,#ee5a6f 100%);padding:14px;text-align:center;color:#fff;border-bottom:3px solid #ff4757;position:relative;overflow:hidden}
  .notice-banner h3{font-weight:800;margin-bottom:6px}
  .notice-banner p{font-size:.95rem}

  /* ---------- header ---------- */
  .header{background:#fff;padding:14px 18px;box-shadow:0 2px 16px rgba(0,0,0,.06);position:sticky;top:0;z-index:900}
  .header-container{max-width:1300px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:18px}
  .left-area{display:flex;align-items:center;gap:14px}
  .logo{width:72px;height:72px;border-radius:50%;overflow:hidden;border:3px solid #667eea;box-shadow:0 6px 20px rgba(102,126,234,.18);flex-shrink:0}
  .logo img{width:100%;height:100%;object-fit:cover}
  .brand-info h1{font-size:1.3rem;font-weight:800;color:#111}
  .brand-info p{font-size:.86rem;color:#666;margin-top:3px}

  .top-controls{display:flex;align-items:center;gap:12px;flex:1;justify-content:flex-end}
  .search-wrap{flex:1;max-width:620px;position:relative}
  .search-box input{width:100%;padding:12px 50px 12px 18px;border:2px solid #e8e8e8;border-radius:50px;font-size:1rem;outline:none}
  .search-box input:focus{border-color:#667eea;box-shadow:0 0 0 6px rgba(102,126,234,.06)}
  .search-btn{position:absolute;right:6px;top:50%;transform:translateY(-50%);width:40px;height:40px;border-radius:50%;border:none;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;cursor:pointer}

  .top-buttons{display:flex;align-items:center;gap:10px}
  .btn{padding:10px 16px;border-radius:999px;font-weight:700;font-size:.95rem;cursor:pointer;border:none;display:inline-flex;align-items:center;gap:8px}
  .btn-login{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;box-shadow:0 12px 30px rgba(102,126,234,.16)}
  .btn-login:hover{transform:translateY(-2px)}
  .btn-settings{background:#fff;border:1px solid #e6e6e6;padding:9px 12px;border-radius:10px;color:#333;cursor:pointer}

  /* settings dropdown */
  .settings-dropdown{position:absolute;right:0;margin-top:8px;background:#fff;border:1px solid #e6e6e6;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.08);display:none;min-width:240px;z-index:2000;overflow:hidden}
  .settings-dropdown.show{display:block}
  .settings-title{padding:12px 14px;font-weight:800;color:#333;border-bottom:1px solid #f0f0f0}
  .settings-item{padding:12px 14px;border-bottom:1px solid #f4f4f4;display:flex;align-items:center;justify-content:space-between;gap:8px}
  .settings-item:last-child{border-bottom:none}
  .lang-list{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  .lang-btn{padding:6px 10px;border-radius:8px;border:1px solid #e6e6e6;background:#fff;cursor:pointer;font-size:.9rem}

  /* ---------- hero (3D/animated gradient) ---------- */
  .hero-wrap{position:relative;height:360px;display:flex;align-items:center;justify-content:center;overflow:hidden}
  /* animated gradient layers to give depth */
  .hero-bg{position:absolute;inset:0;z-index:0;pointer-events:none;overflow:hidden}
  .grad-layer{position:absolute;inset:-20%;background:radial-gradient(circle at 10% 20%, rgba(246,150,255,0.08), transparent 12%), radial-gradient(circle at 80% 80%, rgba(102,126,234,0.08), transparent 12%);transform:translateZ(0);filter:blur(36px);opacity:.9;animation:moveGrad 18s linear infinite}
  .grad-layer.layer-2{filter:blur(54px);opacity:.7;animation-direction:reverse;animation-duration:26s}
  @keyframes moveGrad{0%{transform:translate3d(-10%,0,0) scale(1)}50%{transform:translate3d(10%,0,0) scale(1.05)}100%{transform:translate3d(-10%,0,0) scale(1)}}

  /* floating subtle shapes for 3D feel */
  .float-shapes{position:absolute;inset:0;pointer-events:none}
  .shape{position:absolute;border-radius:14px;background:linear-gradient(135deg,rgba(255,255,255,0.04),rgba(255,255,255,0.02));box-shadow:0 8px 30px rgba(102,126,234,.04);transform:translateZ(0);opacity:.9;animation:floatY 8s ease-in-out infinite}
  .shape.s1{width:220px;height:120px;left:6%;top:12%;transform:rotate(-8deg)}
  .shape.s2{width:160px;height:90px;right:8%;top:18%;transform:rotate(10deg);animation-duration:10s}
  .shape.s3{width:300px;height:160px;left:30%;bottom:10%;transform:rotate(3deg);animation-duration:14s;opacity:.75}
  @keyframes floatY{0%{transform:translateY(0)}50%{transform:translateY(-12px)}100%{transform:translateY(0)}}

  .hero-content{position:relative;z-index:3;text-align:center;color:#fff;padding:18px 20px;max-width:1100px}
  .hero-title{font-size:2.1rem;font-weight:900;letter-spacing:0.2px;margin-bottom:10px;text-shadow:0 10px 30px rgba(0,0,0,.35)}
  .hero-sub{font-size:1.05rem;color:rgba(255,255,255,.92);margin-bottom:18px;text-shadow:0 6px 20px rgba(0,0,0,.25)}
  .hero-ctas{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
  .hero-cta{padding:12px 20px;border-radius:999px;font-weight:800;text-decoration:none}
  .cta-primary{background:linear-gradient(135deg,#ffd54a,#ff8a65);color:#111}
  .cta-secondary{background:rgba(255,255,255,.12);color:#fff;border:1px solid rgba(255,255,255,.18)}

  /* ---------- stats ---------- */
  .stats{padding:54px 20px;background:transparent;position:relative;margin-top:-40px}
  .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;max-width:1200px;margin:0 auto}
  .stat-card{padding:24px;border-radius:16px;background:linear-gradient(145deg,#fff,#fbfbff);border:1px solid #eee;box-shadow:0 8px 30px rgba(0,0,0,.04);text-align:center}
  .stat-number{font-size:2rem;font-weight:900;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:6px}
  .stat-label{color:#666}

  /* ---------- pricing ---------- */
  .pricing{padding:64px 20px;background:#f5f5f5}
  .section-title{text-align:center;font-size:2.1rem;margin-bottom:28px;font-weight:800}
  .pricing-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:20px;max-width:1200px;margin:0 auto}
  .price-card{background:#fff;border-radius:16px;padding:22px;border:1px solid #eaeaea;box-shadow:0 12px 30px rgba(0,0,0,.04);position:relative}
  .price-badge{display:inline-block;padding:6px 12px;border-radius:12px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;font-weight:700;margin-bottom:10px}
  .price{font-size:1.9rem;font-weight:900;color:#667eea;margin-bottom:8px}
  .price-features{list-style:none;margin:16px 0}
  .price-features li{padding:8px 0;border-bottom:1px solid #f0f0f0;display:flex;gap:10px;align-items:center}
  .buy-button{display:block;text-align:center;padding:12px 18px;border-radius:999px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;font-weight:800;text-decoration:none;margin-top:12px;box-shadow:0 12px 30px rgba(102,126,234,.12)}

  /* ---------- review carousel ---------- */
  .review-section{padding:28px 12px;background:#fff;margin:18px 0}
  .review-container{max-width:1200px;margin:0 auto}
  .review-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;flex-wrap:wrap}
  .review-title{font-size:1.25rem;font-weight:800;color:#111}
  .review-sub{color:#666;font-size:.95rem}
  .carousel-viewport{position:relative;overflow:hidden}
  .carousel-track{display:flex;gap:12px;transition:transform 600ms cubic-bezier(.2,.9,.2,1);will-change:transform}
  .review-card{min-width:220px;max-width:220px;background:linear-gradient(145deg,#fff,#fbfbfe);padding:14px;border-radius:12px;border:1px solid #eee;box-shadow:0 8px 24px rgba(0,0,0,.04);display:flex;flex-direction:column;gap:10px}
  .review-top{display:flex;gap:10px;align-items:center}
  .avatar{width:48px;height:48px;border-radius:50%;overflow:hidden;flex-shrink:0;border:2px solid rgba(102,126,234,.12)}
  .avatar img{width:100%;height:100%;object-fit:cover}
  .r-name{font-weight:700}
  .r-meta{font-size:.86rem;color:#666}
  .r-stars{color:#ffd700;font-weight:800}
  .r-text{font-size:.92rem;color:#222;min-height:48px;overflow:hidden}
  .r-emojis{font-size:1rem}
  .carousel-controls{display:flex;gap:8px;align-items:center}
  .carousel-btn{background:#fff;border:1px solid #e6e6e6;padding:8px 10px;border-radius:8px;cursor:pointer}
  .carousel-btn:hover{background:#f6f8ff}
  .btn-primary{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer}
  .btn-secondary{background:#fff;border:1px solid #e6e6e6;padding:10px 14px;border-radius:8px;cursor:pointer}

  /* ---------- modal ---------- */
  .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:12000;padding:20px}
  .modal-overlay.show{display:flex}
  .modal-card{width:100%;max-width:820px;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 24px 80px rgba(0,0,0,.35)}
  .modal-head{padding:12px 16px;border-bottom:1px solid #f0f0f0;display:flex;justify-content:space-between;align-items:center}
  .modal-body{padding:16px}
  .modal-close{background:none;border:none;font-size:22px;cursor:pointer}
  .modal-iframe{width:100%;height:62vh;border:0}

  /* ---------- responsive ---------- */
  @media (max-width:900px){
    .hero-title{font-size:1.6rem}
    .search-box input{padding:10px 46px 10px 14px}
    .review-card{min-width:200px;max-width:200px}
    .hero-wrap{height:320px}
  }
  @media (max-width:600px){
    .header-container{flex-direction:column;align-items:stretch;gap:10px}
    .left-area{width:100%;justify-content:flex-start}
    .top-controls{justify-content:space-between}
    .search-wrap{order:3;width:100%}
    .hero-wrap{height:260px}
  }
</style>
</head>
<body>
  <div class="progress-bar" id="progressBar"></div>

  <!-- NOTICE -->
  <section class="notice-banner">
    <div style="max-width:1200px;margin:0 auto">
      <h3>‚ö†Ô∏è IMPORTANT NOTICE</h3>
      <p><strong>Once you purchase any subscription, the payment is NON-REFUNDABLE.</strong> Please purchase at your own risk and discretion.</p>
    </div>
  </section>

  <!-- HEADER -->
  <header class="header">
    <div class="header-container">
      <div class="left-area">
        <div class="logo"><img src="https://i.ibb.co/HTmgqXLh/Picsart-25-11-04-05-36-14-228.png" alt="Alpha Pandit Ji"></div>
        <div class="brand-info">
          <h1>Alpha Pandit Ji</h1>
          <p>Premium Spiritual Content & Exclusive Services</p>
        </div>
        <div>
          <button id="loginBtnTop" class="btn btn-login">Sign Up / Login</button>
        </div>
      </div>

      <div class="top-controls">
        <div class="search-wrap" style="position:relative">
          <div class="search-box">
            <input id="searchInput" type="text" placeholder="Search subscriptions, products, services..." autocomplete="off">
            <button class="search-btn" type="button" title="Search" onclick="performSearch()">
              <svg viewBox="0 0 24 24" width="18" height="18" fill="#fff"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5z"/></svg>
            </button>
          </div>
        </div>

        <div style="position:relative">
          <button id="settingsBtn" class="btn btn-settings" title="Settings">‚öôÔ∏è Settings</button>
          <div id="settingsDropdown" class="settings-dropdown" aria-hidden="true">
            <div class="settings-title">Settings</div>
            <div class="settings-item" style="flex-direction:column;align-items:flex-start;">
              <div style="font-weight:700;margin-bottom:8px">Language</div>
              <div class="lang-list" id="langList">
                <button class="lang-btn" data-lang="hi">Hindi</button>
                <button class="lang-btn" data-lang="en">English</button>
                <button class="lang-btn" data-lang="en-IN">English (India)</button>
                <button class="lang-btn" data-lang="es">Spanish</button>
                <button class="lang-btn" data-lang="fr">French</button>
              </div>
            </div>
            <div class="settings-item" style="justify-content:center;background:#fff;">
              <button id="logoutBtn" class="btn-secondary" style="width:100%;">Logout</button>
            </div>
          </div>
        </div>

      </div>
    </div>
  </header>

  <!-- HERO (3D-ish animated gradient + subtle shapes) -->
  <section class="hero-wrap" aria-hidden="false">
    <div class="hero-bg">
      <div class="grad-layer layer-1"></div>
      <div class="grad-layer layer-2"></div>
    </div>
    <div class="float-shapes" aria-hidden="true">
      <div class="shape s1"></div>
      <div class="shape s2"></div>
      <div class="shape s3"></div>
    </div>
    <div class="hero-content">
      <div class="hero-title">Spiritual Guidance ‚Ä¢ Exclusive Tools ‚Ä¢ Trusted Community</div>
      <div class="hero-sub">Join thousands who get daily spiritual content, premium tools and 1-on-1 guidance.</div>
      <div class="hero-ctas">
        <a href="#pricing" class="hero-cta cta-primary">View Plans</a>
        <button id="ctaSign" class="hero-cta cta-secondary">Quick Sign Up</button>
      </div>
    </div>
  </section>

  <!-- STATS -->
  <section class="stats">
    <div class="stats-grid">
      <div class="stat-card"><div class="stat-number" data-target="5000">0</div><div class="stat-label">Happy Members</div></div>
      <div class="stat-card"><div class="stat-number" data-target="10000">0</div><div class="stat-label">Content Downloads</div></div>
      <div class="stat-card"><div class="stat-number" data-target="50">0</div><div class="stat-label">Premium Apps Unlocked</div></div>
      <div class="stat-card"><div class="stat-number" data-target="99">0</div><div class="stat-label">Customer Satisfaction</div></div>
    </div>
  </section>

  <!-- PRICING (Alternative Form removed; Buy Now active) -->
  <section class="pricing" id="pricing">
    <h2 class="section-title">Choose Your Premium Plan</h2>
    <div class="pricing-grid">
      <div class="price-card" data-plan="basic">
        <span class="price-badge">BASIC</span>
        <h3>Basic Plan</h3>
        <div class="price">‚Çπ199<span style="font-size:.85rem;color:#777;font-weight:600">/month</span></div>
        <ul class="price-features">
          <li>Premium Telegram Channel Access</li>
          <li>Daily Spiritual Content</li>
          <li>Community Support</li>
          <li>30 Days Validity</li>
        </ul>
        <a href="https://imjo.in/v8sXQG" class="buy-button" target="_blank" rel="noopener">Buy Now</a>
      </div>

      <div class="price-card featured" data-plan="premium">
        <span class="price-badge">‚≠ê MOST POPULAR</span>
        <h3>Premium Plan</h3>
        <div class="price">‚Çπ499<span style="font-size:.85rem;color:#777;font-weight:600">/month</span></div>
        <ul class="price-features">
          <li>All Basic Features</li>
          <li>WhatsApp Group Access</li>
          <li>Priority Support</li>
          <li>Exclusive Spiritual Content</li>
        </ul>
        <a href="https://imjo.in/mKZYp9" class="buy-button" target="_blank" rel="noopener">Buy Now</a>
      </div>

      <div class="price-card" data-plan="premium-plus">
        <span class="price-badge">üíé VIP</span>
        <h3>Premium Plus</h3>
        <div class="price">‚Çπ999<span style="font-size:.85rem;color:#777;font-weight:600">/month</span></div>
        <ul class="price-features">
          <li>Daily New Updates For Social Media</li>
          <li>Personal Guide For Only Plus Members</li>
          <li>All Premium Features</li>
        </ul>
        <a href="https://imjo.in/g9YxyK" class="buy-button" target="_blank" rel="noopener">Buy Now</a>
      </div>

      <div class="price-card" data-plan="enterprise">
        <span class="price-badge">üíº ENTERPRISE</span>
        <h3>Enterprise Plan</h3>
        <div class="price">‚Çπ1999<span style="font-size:.85rem;color:#777;font-weight:600">/month</span></div>
        <ul class="price-features">
          <li>All Premium Plus Features</li>
          <li>24/7 Priority Support</li>
          <li>Custom Content Creation Service</li>
        </ul>
        <a href="https://imjo.in/enterprise" class="buy-button" target="_blank" rel="noopener">Buy Now</a>
      </div>
    </div>
  </section>

  <!-- REVIEW SECTION (carousel style) -->
  <section class="review-section" aria-label="Reviews">
    <div class="review-container">
      <div class="review-header">
        <div>
          <div class="review-title">What our audience says</div>
          <div class="review-sub">Real people ‚Äî real experiences. Average rating <strong id="avgRating">4.7 ‚≠ê</strong></div>
        </div>
        <div class="carousel-controls">
          <button id="prevBtn" class="carousel-btn" aria-label="Previous">‚óÄ</button>
          <button id="nextBtn" class="carousel-btn" aria-label="Next">‚ñ∂</button>
          <button id="openReviewBtn" class="btn btn-primary" style="margin-left:10px">Give Your Review</button>
        </div>
      </div>

      <div class="carousel-viewport" aria-hidden="false" style="padding-bottom:10px">
        <div id="carouselTrack" class="carousel-track" aria-live="polite" role="list">
          <!-- Cards injected via JS -->
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer">
    <h3 class="footer-title">Follow Us on Social Media</h3>
    <div style="display:flex;justify-content:center;gap:16px;margin-bottom:14px;flex-wrap:wrap">
      <a href="#" target="_blank" style="text-decoration:none;color:inherit">Instagram</a>
      <a href="#" target="_blank" style="text-decoration:none;color:inherit">YouTube</a>
      <a href="#" target="_blank" style="text-decoration:none;color:inherit">Telegram</a>
      <a href="#" target="_blank" style="text-decoration:none;color:inherit">WhatsApp</a>
    </div>
    <p>&copy; 2025 Alpha Pandit Ji | All Rights Reserved</p>
    <p>Secure payments powered by <a href="https://www.instamojo.com" target="_blank">Instamojo</a></p>
    <p>Made with ‚ù§Ô∏è in India</p>
  </footer>

  <!-- LOGIN MODAL (Google Form) -->
  <div id="loginModal" class="modal-overlay" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-label="Sign up form">
      <div class="modal-head">
        <strong>Sign Up / Login</strong>
        <button class="modal-close" id="loginModalClose" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <p style="font-weight:700;margin-bottom:8px;">Please fill this form to sign up / login</p>
        <iframe class="modal-iframe" id="googleFormIframe"
          src="https://docs.google.com/forms/d/e/1FAIpQLSciLA2M3H1XVJdVWmbWKhpuwZgLLRIUMAkArIVRHH7u-zoLEg/viewform?usp=dialog"
          title="Google Form"></iframe>
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:12px">
          <button id="confirmSubmittedBtn" class="btn btn-primary">I submitted the form</button>
          <button id="closeLoginModal" class="btn-secondary">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- REVIEW SUBMIT MODAL -->
  <div id="reviewModal" class="modal-overlay" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-label="Leave a review">
      <div class="modal-head">
        <strong>Leave a Review</strong>
        <button class="modal-close" id="reviewModalClose" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <label style="font-weight:700">Your name</label>
        <input id="reviewerName" type="text" style="width:100%;padding:10px;border-radius:8px;border:1px solid #eee;margin-top:8px;margin-bottom:10px" placeholder="Your name">
        <label style="font-weight:700">Rating</label>
        <div id="ratingInput" style="display:flex;gap:8px;font-size:1.6rem;color:#ffd700;margin-top:8px;margin-bottom:10px;cursor:pointer">
          <span data-value="1">‚òÜ</span><span data-value="2">‚òÜ</span><span data-value="3">‚òÜ</span><span data-value="4">‚òÜ</span><span data-value="5">‚òÜ</span>
        </div>
        <div class="review-input">
          <label style="font-weight:700">Your review</label>
          <textarea id="reviewMessage" placeholder="Write your review..." style="width:100%;min-height:100px;padding:10px;border-radius:8px;border:1px solid #eee;margin-top:8px"></textarea>
        </div>
        <div class="review-actions" style="margin-top:12px;display:flex;gap:10px;justify-content:flex-end">
          <button id="submitReview" class="btn-primary">Submit</button>
          <button id="cancelReview" class="btn-secondary">Cancel</button>
        </div>
        <div id="reviewSavedMsg" style="color:green;margin-top:10px;font-weight:700;display:none">Thanks ‚Äî your review was saved locally.</div>
      </div>
    </div>
  </div>

<script>
/* ------------------------------
   Progress bar
   ------------------------------ */
window.addEventListener('scroll', () => {
  const winScroll = document.documentElement.scrollTop || document.body.scrollTop;
  const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
  const scrolled = (height > 0) ? (winScroll / height) * 100 : 0;
  document.getElementById('progressBar').style.width = scrolled + '%';
});

/* ------------------------------
   Counters (small animation)
   ------------------------------ */
(function(){
  const counters = document.querySelectorAll('.stat-number');
  const speed = 200;
  counters.forEach(counter => {
    const updateCount = () => {
      const target = +counter.getAttribute('data-target');
      const count = +counter.innerText;
      const inc = Math.max(1, Math.floor(target / speed));
      if (count < target) {
        counter.innerText = Math.min(target, count + inc);
        setTimeout(updateCount, 10);
      } else {
        counter.innerText = target + (target === 99 ? '%' : '+');
      }
    };
    const obs = new IntersectionObserver(entries => {
      if (entries[0].isIntersecting) { updateCount(); obs.disconnect(); }
    }, {threshold:0.5});
    obs.observe(counter);
  });
})();

/* ------------------------------
   Hero CTA binds
   ------------------------------ */
document.getElementById('ctaSign').addEventListener('click', () => {
  // open the Google Form modal (optional sign up)
  openLoginModal();
});

/* ------------------------------
   Settings dropdown and language/save/logout
   ------------------------------ */
const settingsBtn = document.getElementById('settingsBtn');
const settingsDropdown = document.getElementById('settingsDropdown');
settingsBtn.addEventListener('click', e => {
  e.stopPropagation();
  settingsDropdown.classList.toggle('show');
});
document.addEventListener('click', e => {
  if(!e.target.closest('#settingsDropdown') && !e.target.closest('#settingsBtn')){
    settingsDropdown.classList.remove('show');
  }
});
document.querySelectorAll('.lang-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const lang = btn.getAttribute('data-lang');
    localStorage.setItem('apj_lang', lang);
    document.documentElement.lang = lang;
    btn.textContent = btn.textContent + ' ‚úì';
    setTimeout(()=> btn.textContent = btn.textContent.replace(' ‚úì',''),900);
  });
});
document.getElementById('logoutBtn').addEventListener('click', ()=>{
  // logout simply clears sign-up flag (optional)
  localStorage.removeItem('apj_loggedIn');
  settingsDropdown.classList.remove('show');
  alert('You have been logged out.');
  location.reload();
});
(function(){ const lang = localStorage.getItem('apj_lang'); if(lang) document.documentElement.lang = lang; })();

/* ------------------------------
   Search (minimal handling)
   ------------------------------ */
const searchInput = document.getElementById('searchInput');
function performSearch(){ searchInput.focus(); }

/* ------------------------------
   Login modal (Google Form) behavior
   ------------------------------ */
const loginBtnTop = document.getElementById('loginBtnTop');
const loginModal = document.getElementById('loginModal');
const loginModalClose = document.getElementById('loginModalClose');
const closeLoginModal = document.getElementById('closeLoginModal');
const confirmSubmittedBtn = document.getElementById('confirmSubmittedBtn');

function openLoginModal(){ loginModal.classList.add('show'); loginModal.setAttribute('aria-hidden','false'); document.body.style.overflow = 'hidden'; }
function closeLoginModalFn(){ loginModal.classList.remove('show'); loginModal.setAttribute('aria-hidden','true'); document.body.style.overflow = ''; }

loginBtnTop.addEventListener('click', openLoginModal);
loginModalClose.addEventListener('click', closeLoginModalFn);
closeLoginModal.addEventListener('click', closeLoginModalFn);
loginModal.addEventListener('click', (e)=> { if(e.target===loginModal) closeLoginModalFn(); });

// Confirm submission - optional: mark local flag so UI could show logged-in if needed
confirmSubmittedBtn.addEventListener('click', ()=>{
  localStorage.setItem('apj_loggedIn','true');
  closeLoginModalFn();
  alert('Thank you ‚Äî you are now signed in for this browser session.');
});

/* ------------------------------
   Reviews: generate large dummy list (120) if not present
   ------------------------------ */
const sampleFirst = ['Rahul','Priya','Aman','Meena','Sonal','Vikram','Neha','Ravi','Anjali','Karan','Nisha','Suresh','Pooja','Amit','Ritu','Deepak','Tanu','Isha','Manish','Rohan','Sana','Kabir','Maya','Arjun','Simran','Aditya','Rakesh','Anita','Rekha','Vivek','Kriti','Shiv','Gauri','Yash','Abeer','Farah','Rhea','Imran','Sahil','Tarun','Mona','Lalit','Punit','Kavya','Nayan','Zoya','Harsh','Dev','Leena','Irfan','Jaya','Ritika','Kamal','Suman','Neeraj','Biplab','Ojas','Rashmi','Sheetal','Tara','Yuvraaj','Bhavya','Mili','Rinku','Nitin','Priyanka','Ashok','Bhavana','Chirag','Diksha','Esha','Faiz','Gautam','Hina','Ila','Jatin','Kiran','Lata','Mukul','Nandini','Om','Poonam','Qasim','Radhika','Sarita','Tanya','Uday','Vandana','Waseem','Xenia','Yogesh','Zain','Aaliya','Bina','Charu','Dia','Ekta','Farhan','Gina','Hiral','Indu','Jiya','Keshav'];
const emojis = ['üòç','üî•','üòä','‚ú®','üëç','üíØ','üôè','ü§©','üëè','‚≠ê'];

function randomRating(){ return (Math.random()*0.6 + 4.4).toFixed(1); } // ~4.4 - 5.0
function makeName(i){ return sampleFirst[i % sampleFirst.length] + (Math.random()<0.12 ? ' ' + (Math.floor(Math.random()*90)+10) : ''); }

let reviews = JSON.parse(localStorage.getItem('apj_reviews') || '[]');
if(reviews.length === 0){
  const generated = [];
  for(let i=0;i<120;i++){
    const name = makeName(i);
    const rating = parseFloat(randomRating());
    const avatarId = (i % 70) + 1;
    const avatar = 'https://i.pravatar.cc/150?img=' + avatarId;
    const emoji = emojis[i % emojis.length];
    const texts = [
      "Amazing service! " + emoji,
      "Really helped me a lot. " + emoji,
      "High quality content and support. " + emoji,
      "Recommended to friends! " + emoji,
      "Great value for money. " + emoji,
      "Very satisfied with the guidance. " + emoji
    ];
    const text = texts[i % texts.length];
    generated.push({ name, rating, avatar, text });
  }
  localStorage.setItem('apj_reviews', JSON.stringify(generated));
  reviews = generated;
}

/* ------------------------------
   Carousel render
   ------------------------------ */
const carouselTrack = document.getElementById('carouselTrack');
function escapeHtml(s){ return String(s).replace(/[&<>"']/g,function(m){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]}); }

function buildCardHTML(review){
  const starsFull = Math.floor(review.rating);
  const half = (review.rating - starsFull) >= 0.5;
  let stars = '';
  for(let i=0;i<5;i++){
    if(i < starsFull) stars += '‚òÖ';
    else if(i === starsFull && half) stars += '‚òÖ';
    else stars += '‚òÜ';
  }
  const emojisDisplay = (Math.random()<0.6) ? (emojis[Math.floor(Math.random()*emojis.length)]) : '';
  return `
    <article class="review-card" role="listitem" aria-label="Review by ${escapeHtml(review.name)}">
      <div class="review-top">
        <div class="avatar"><img src="${escapeHtml(review.avatar)}" alt="${escapeHtml(review.name)}"></div>
        <div style="flex:1">
          <div class="r-name">${escapeHtml(review.name)}</div>
          <div class="r-meta"><span class="r-stars">${stars}</span> <span style="color:#777;font-weight:700"> ${parseFloat(review.rating).toFixed(1)}</span></div>
        </div>
      </div>
      <div class="r-text">${escapeHtml(review.text)}</div>
      <div class="r-emojis">${emojisDisplay}</div>
    </article>
  `;
}

function renderCarousel(){
  reviews = JSON.parse(localStorage.getItem('apj_reviews') || '[]');
  const html = reviews.map(r => buildCardHTML(r)).join('');
  // duplicate to create long continuous track for smooth loop
  carouselTrack.innerHTML = html + html;
  updateAvgRating();
}
renderCarousel();

/* ------------------------------
   Average rating display
   ------------------------------ */
function updateAvgRating(){
  const arr = JSON.parse(localStorage.getItem('apj_reviews') || '[]');
  if(arr.length === 0) return document.getElementById('avgRating').textContent = '0.0 ‚≠ê';
  const avg = (arr.reduce((s,i)=> s + (parseFloat(i.rating)||0),0) / arr.length);
  document.getElementById('avgRating').innerHTML = avg.toFixed(1) + ' ‚≠ê';
}
updateAvgRating();

/* ------------------------------
   Carousel auto-scroll & controls
   ------------------------------ */
let trackPos = 0;
let itemWidth = 236;
function updateItemWidth(){
  const first = carouselTrack.querySelector('.review-card');
  if(first){
    const style = getComputedStyle(first);
    const w = first.offsetWidth + (parseInt(style.marginRight) || 12);
    itemWidth = Math.max(200, w + 12);
  }
}
updateItemWidth();
window.addEventListener('resize', updateItemWidth);

let autoScrollId = null;
const msPerPixel = 8;
function startAutoScroll(){
  stopAutoScroll();
  autoScrollId = setInterval(()=> {
    trackPos += 1;
    carouselTrack.style.transform = `translateX(${-trackPos}px)`;
    const trackWidth = carouselTrack.scrollWidth / 2;
    if(trackPos >= trackWidth) trackPos = 0;
  }, Math.max(10, msPerPixel));
}
function stopAutoScroll(){ if(autoScrollId){ clearInterval(autoScrollId); autoScrollId = null; } }
startAutoScroll();

const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
prevBtn.addEventListener('click', ()=>{
  trackPos = Math.max(0, trackPos - itemWidth);
  carouselTrack.style.transform = `translateX(${-trackPos}px)`;
});
nextBtn.addEventListener('click', ()=>{
  trackPos = trackPos + itemWidth;
  carouselTrack.style.transform = `translateX(${-trackPos}px)`;
});

const carouselViewport = document.querySelector('.carousel-viewport');
carouselViewport.addEventListener('mouseenter', ()=> stopAutoScroll());
carouselViewport.addEventListener('mouseleave', ()=> startAutoScroll());

/* ------------------------------
   Review submission modal logic
   ------------------------------ */
const openReviewBtn = document.getElementById('openReviewBtn');
const reviewModal = document.getElementById('reviewModal');
const reviewModalClose = document.getElementById('reviewModalClose');
const cancelReview = document.getElementById('cancelReview');
const submitReview = document.getElementById('submitReview') || document.getElementById('submitReview'); // safe
const reviewerName = document.getElementById('reviewerName');
const reviewMessage = document.getElementById('reviewMessage');
const ratingInput = document.getElementById('ratingInput');
const reviewSavedMsg = document.getElementById('reviewSavedMsg');

function openReviewModal(){ reviewModal.classList.add('show'); reviewModal.setAttribute('aria-hidden','false'); document.body.style.overflow = 'hidden'; }
function closeReviewModal(){ reviewModal.classList.remove('show'); reviewModal.setAttribute('aria-hidden','true'); document.body.style.overflow = ''; clearReviewFields(); }

openReviewBtn.addEventListener('click', openReviewModal);
reviewModalClose.addEventListener('click', closeReviewModal);
cancelReview.addEventListener('click', closeReviewModal);
reviewModal.addEventListener('click', (e)=> { if(e.target===reviewModal) closeReviewModal(); });

let chosenRating = 5;
ratingInput.querySelectorAll('span').forEach(span=>{
  span.addEventListener('click', ()=> {
    chosenRating = parseInt(span.getAttribute('data-value'));
    ratingInput.querySelectorAll('span').forEach(s => s.textContent = (parseInt(s.getAttribute('data-value')) <= chosenRating ? '‚òÖ' : '‚òÜ'));
  });
});
ratingInput.querySelectorAll('span').forEach((s,i)=> s.textContent = '‚òÜ');

function clearReviewFields(){
  reviewerName.value = '';
  reviewMessage.value = '';
  chosenRating = 5;
  ratingInput.querySelectorAll('span').forEach((s,i)=> s.textContent = '‚òÜ');
  reviewSavedMsg.style.display = 'none';
}

document.getElementById('submitReview').addEventListener('click', ()=>{
  const name = (reviewerName.value || 'Anonymous').trim();
  const text = (reviewMessage.value || 'Great experience!').trim();
  const rating = chosenRating || 5;
  const avatar = 'https://i.pravatar.cc/150?img=' + (Math.floor(Math.random()*70) + 1);
  const reviewObj = { name, rating, avatar, text };
  const arr = JSON.parse(localStorage.getItem('apj_reviews') || '[]');
  arr.unshift(reviewObj);
  localStorage.setItem('apj_reviews', JSON.stringify(arr));
  reviews = arr;
  renderCarousel();
  reviewSavedMsg.style.display = 'block';
  updateAvgRating();
  setTimeout(()=> { reviewSavedMsg.style.display = 'none'; closeReviewModal(); }, 900);
});

/* ------------------------------
   Accessibility: ESC to close modals
   ------------------------------ */
document.addEventListener('keydown', (e)=> {
  if(e.key === 'Escape'){
    if(loginModal.classList.contains('show')) closeLoginModalFn();
    if(reviewModal.classList.contains('show')) closeReviewModal();
  }
});

/* ------------------------------
   Keep carousel fresh when other tabs update storage
   ------------------------------ */
window.addEventListener('storage', (e)=>{
  if(e.key === 'apj_reviews'){ renderCarousel(); updateAvgRating(); }
});

/* ------------------------------
   ensure render on focus
   ------------------------------ */
window.addEventListener('focus', ()=> renderCarousel());

</script>
</body>
</html>
